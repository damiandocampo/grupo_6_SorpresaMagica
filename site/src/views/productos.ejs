<!DOCTYPE html>
<html lang="es">

<%- include('./partials/head', {title: 'Productos' }) %>

<script src="/js/productsOrderBy.js"></script>
<script src="/js/productsFilters.js"></script>

<body>
    
    <%- include('./partials/header') %> 

    <main class="listado-productos">
        
        <div class="filtros-orden">

            <div class="filtros-container">

                <label class="filtrar" for="filtros-hidden"> Filtrar <i class="fas fa-filter"></i> </label>
                <input type="checkbox" name="filtros" id="filtros-hidden" class="filtros-hidden">

                <div class="filtros">

                    <h2>Filtrar <i class="fas fa-filter"></i></h2>
                    
                    <form action="/productos" method="get" class="filterBy">

                    <div class="categorias">
                        <input type="checkbox" name="" id="f-categorias"><label for="f-categorias" class="titulo">Categorías</label>
                        <ul>
                        <% categories.forEach(category => { %> 
                            <li>
                                <input type="checkbox" class="inputs cb-categories" name="c" value="<%= category.id %>" id="<%= category.name %>">
                                <label for="<%= category.name %>"> <%= category.name %> </label>
                            </li>
                        <% }) %>
                        </ul>
                    </div>

                    <div class="marcas">
                        <input type="checkbox" name="" id="f-marcas"><label for="f-marcas" class="titulo">Marcas</label>
                        <ul>
                        <% brands.forEach(brand => { %> 
                            <li>
                                <input type="checkbox" class="inputs cb-brands" name="m" value="<%= brand.id %>" id="<%= brand.name %>">
                                <label for="<%= brand.name %>"> <%= brand.name %> </label>
                            </li>
                        <% }) %> 
                        </ul>
                    </div>

                    <div class="descuentos">
                        <input type="checkbox" name="" id="f-descuentos"><label for="f-descuentos" class="titulo">Descuentos</label>
                        <ul>
                        <% if(discounts.length > 0) {
                            discounts.forEach(discount => { %> 
                                <li>
                                    <input type="checkbox" class="inputs cb-discounts" name="d" value="<%= discount %>" id="<%= discount %>">
                                    <label for="<%= discount %>"> <%= discount %>% </label>
                                </li>
                            <% })
                        } else {%>
                            <li><label>No hay descuentos</label></li>
                        <% } %>
                        </ul>
                    </div>

                    </form>
                    
                </div>

            </div>
            
            <div class="orden-container">

                <input type="checkbox" name="orden" id="orden-hidden" class="orden-hidden">
                <label class="ordenar" for="orden-hidden"> Ordenar por: 
                <form action="/productos" method="get" class="orderBy">
                    <select name="orderBy" class="orderOptions">
                        <option class="optionAZ" value="az">A-Z</option>
                        <option class="optionZA" value="za">Z-A</option>
                        <option class="menorPrecio" value="menorPrecio">$</option>
                        <option class="mayorPrecio" value="mayorPrecio">$$$</option>
                    </select>
                </form>
                </label>

            </div> 

        </div>
        
        
        <div class="productos">

            <% if(products != '') { %>

                <% products.forEach(product=> { %>
                    <article>
                        <a href="/productos/detalle/<%= product.id %>">
                            <img src="/images/productos/<%= product.image %>" alt="<%= product.title %>">
                        </a>
                        <div class="descripcion">
                            <a href="/productos/detalle/<%= product.id %>">
                                <h5>
                                    <%= product.brand.name %>
                                </h5>
                            </a>
                            <h3>
                                <a href="/productos/<%= product.id %>">
                                    <%= product.title %>
                                </a>
                            </h3>
                            <% if (product.discount > 0) { %> 
                                <div class="precio">
                                    <small>
                                        $<%= product.price %> 
                                    </small>
                                    <h2>
                                        $<%= finalPrice(product.price, product.discount) %>
                                    </h2>
                                    <h3>
                                        <%= product.discount %>% 
                                    </h3>
                                </div>
                            <% } else { %>
                                    <h2>
                                        $<%= product.price %>
                                    </h2>
                            <% } %>
                            <div class="cantidad">
                                <button>-</button>
                                <p>1</p>
                                <button>+</button>
                            </div>
                            <div class="comprar">
                                <button type="submit">Agregar al carrito</button>
                            </div>
                        </div>
                    </article>
                <% }) %>

            <% } else { %> 
                <h2 class="noResults">No se encontraron resultados para tu búsqueda</h2>
            <% } %> 

        </div>


    </main>

    <%- include('./partials/footer') %> 

</body>
</html>